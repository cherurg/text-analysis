The Battle for Wesnoth (локализованная версия — «Битва за Веснот», также называют просто «Веснот») — пошаговая стратегическая компьютерная игра в жанре фэнтези, созданная независимым коллективом разработчиков и распространяемая полностью по свободной лицензии GNU General Public License. Исходный код доступен на сайте игры, там же имеются инструкции по сборке из исходных кодов и готовые пакеты для Microsoft Windows, Mac OS X, различных версий Linux и других операционных систем.


== Игровой процесс ==
Графическое оформление игры двумерное, с анимированными персонажами и некоторыми деталями ландшафта, что критикуется некоторыми пользователями как устаревшее решение в эпоху трёхмерных стратегий. Однако тщательная и качественная отрисовка всех деталей позволяет говорить об интерфейсе как о приятном и удобном.
Игровой процесс содержит элементы как классической пошаговой стратегии, так и ролевой игры. Игрок, располагая вначале всего одним воином (лидером), должен создать большую армию и, воспитав из неопытных призывников мощных бойцов-ветеранов, уничтожить лидеров противника. Соответственно, если будет убит лидер игрока, ему засчитают поражение. В некоторых кампаниях поражением также будет смерть ключевых персонажей, сопровождающих лидера по ходу развития сюжета. Иногда для победы необходима добыча или защита важного артефакта, и т. д. Перед началом каждой новой битвы показывается окно, где изложены условия победы и поражения, а порой и полезный совет.
Не только лидер, но каждый юнит в игре — это отдельный индивидуум с определёнными боевыми качествами, запасом здоровья (heal points), собственным именем (кроме мертвецов, механизмов и монстров), иногда также с собственным характером и историей, раскрываемыми по ходу сюжета. В ходе сражений, а особенно — убивая противника, боец приобретает опыт, который по достижении некоторого значения позволяет ему перейти на новый уровень и превратиться в более живучего и тяжело вооружённого воина. Исход каждого конкретного поединка отдельно взятых бойцов зависит от многих факторов: время суток, ландшафт, тип оружия (атаки), раса, класс бойца, индивидуальные особенности, опыт, состояние здоровья. Также присутствует элемент случайности, который иногда полностью нивелирует эти различия. Тем не менее, в среднем по игре отклонения от прогнозируемых значений попаданий незначительны, и выиграть целую партию на чистом везении практически невозможно.
«Битва за Веснот» достаточно, но не чрезмерно сложна. Компьютерные противники отличаются довольно неплохим интеллектом: применяют атаки с нескольких направлений, выбирают наиболее подходящие к ситуации войска, атакуют самых слабых бойцов (или ключевых персонажей, смерть которых означает поражение игрока) и отводят назад своих пострадавших в бою воинов. Поэтому метод примитивного «давления числом» против компьютера не работает, необходимо тщательно продумывать тактику. Однако компьютерный игрок никогда полностью не переходит к обороне, продолжает атаковать, даже понеся большие потери и оказавшись в меньшинстве, что облегчает победу над ним.


=== Кампании ===
Однопользовательский режим игры состоит в прохождении кампаний. Кампания представляет собой серию из определённого числа сражений-сценариев. Сюжеты кампаний взаимосвязаны и повествуют о возникновении и жизни фантастического королевства Веснот и сопредельных государств в мире под названием Ирдия. События некоторых кампаний даже происходят в одно и то же время и могут между собой пересекаться. Протяжённость саги о Весноте составляет сотни лет (в самой игре она раскрывается с помощью заставок перед сценариями и диалогов в сценариях). Это позволяет практически неограниченно создавать дополнительные кампании, множество которых доступно в дополнениях и может быть легко загружено непосредственно из программы.
В первой стабильной версии игры — 1.0 — было всего шесть предустановленных кампаний, в версии 1.10 — уже шестнадцать. В последней версии, 1.12, их число не изменилось, но сами кампании были доработаны.
Наследник престола (рекомендуется начинающим игрокам для изучения игры);
Сказание о Двух Братьях;
Набег орков;
Южная стража;
Освобождение;
Легенда Весмира;
Вторжение с Востока;
Молот Тургасана;
Спускаясь во тьму;
Мемуары Делфадора;
Мёртвые воды;
Огненный скипетр;
Сын Чёрного Глаза;
На заре Веснота (содержит множество сведений по общему сюжету);
Северное возрождение;
Под палящими светилами.
Используя встроенные средства — редактор карт и мощный скриптовый язык, пользователь может создавать собственные карты и целые кампании. Разумеется, они могут иметь совершенно произвольные сюжеты.


=== Расы Веснота и общая характеристика бойцов ===

Всего в игре можно насчитать 18 рас: водяные, волки, гномы, гоблины, грифоны, дрейки, летучие мыши, лешие, люди, мертвецы, механизмы, монстры, наги, огры, орки, тролли, эльфы, ящеры. В каждой расе есть различные типы бойцов. Некоторые расы объединяются во фракции: так, фракция «Северяне» включает орков, троллей и гоблинов.
В характеристику любого бойца входят базовые параметры: максимальный уровень здоровья, максимальная дальность хода, опыт, уровень, мировоззрение (восприимчивость к времени суток; зависит от расы). В зависимости от оружия, которым пользуется боец, присутствует понятие типа атаки (всего шесть) и особенностей оружия (их двенадцать). Соответственно, каждый воин обладает характеристикой сопротивляемости к различным типам атаки (в процентах), и существует понятие шанса попадания, который зависит прежде всего от ландшафта, а также от особенностей оружия. Некоторые типы бойцов обладают особыми способностями (их 14), например, ящер-авгур обладает способностью лечить близстоящие дружественные юниты на 4 единицы здоровья каждый ход. Кроме того, каждый боец может иметь две (из шестнадцати) индивидуальные особенности, слегка изменяющие его базовые характеристики, но бывают исключения: так, мертвецы имеют лишь одну особенность — «мертвец» (позволяет им не бояться особенностей оружия «яд», «высасывание» и «чума», а также плавать под водой), а лешие вообще не имеют особенностей.


=== Ландшафт ===
Поле боя может быть покрыто самыми разными типами ландшафта: травой, грунтом, камнями, водой, горами, болотами, лесами, грибными рощами и другими. Тип ландшафта влияет на скорость перемещения разных видов бойцов и на их защищённость на различных покрытиях. Например, гномы в горах могут иметь защиту от попадания 70 %, а на равнине только 30 %; всадники хорошо перемещаются по ландшафтам типа «дорога» или «равнина», но сильно замедляются в пещерах. Кроме того, некоторые типы ландшафтов могут быть непроходимыми ни для кого (например, тип «высокие горы») или для конкретных типов бойцов (например, лаву или пропасть могут пересекать лишь летающие бойцы).
Особым типом ландшафта являются деревни. В них многие бойцы имеют защиту от попадания на уровне 60-70 %, и, кроме того, если боец ранен, на каждом ходу у него восстанавливается 8 пунктов здоровья. Поэтому деревни часто служат важными опорными пунктами в битве.


=== Эры ===
Эра в Весноте — это группа фракций и набор правил для них. Существует четыре стандартные встроенные эры:
По умолчанию. Доступны фракции: Верноподданные, Мятежники, Северяне, Мертвецы, Альянс Кналга, Дрейки. Для вербовки доступны бойцы первого уровня;
По умолчанию + Халифат. Доступны те же фракции и в дополнение к ним — фракция Халифат. Для вербовки доступны бойцы первого уровня;
Эпоха героев. Аналогична эре По умолчанию, только для вербовки доступны бойцы второго уровня, а лидер имеет третий уровень;
Эпоха героев + Халифат. Аналогична эре По умолчанию + Халифат, для вербовки доступны бойцы второго уровня, а лидер имеет третий уровень.
В ранних версиях присутствовала эра Великая война, которую убрали в связи с несбалансированностью фракций. Она включала всего две фракции — Альянс света и Альянс тьмы, кудв входили соответственно порядочные и хаотичные персонажи.
Также игроки могут создавать и собственные эры. В одних эрах упор делается на создание новых рас и фракций, в других — преимущественно на модификацию правил для имеющихся фракций. В версии 1.12 в комплект игры входит только одна эра с модифицированными правилами — Новые земли.


=== Экономика Веснота ===
Экономическая сторона в игре развита слабо. В этом плане «Битва за Веснот» очень напоминает игру Warlords. Добыча ресурсов и строительство зданий не производятся (за исключением некоторых сценариев в многопользовательской игре), а доход игроку приносят принадлежащие ему замок-укрепление и деревни, которые можно захватывать.
В начале каждого сценария даётся некая минимальная сумма денег. В кампаниях при досрочном завершении предыдущего сценария игрок получает в придачу денежный бонус за каждый неиспользованный ход. Каждая контролируемая деревня при стандартных настройках даёт по две единицы золота в казну, а также один золотой для содержания бойцов. Иногда в сценариях встречаются денежные клады. Собранные таким образом средства тратятся на вербовку солдат и выплату им жалованья.
Вербовка каждого воина требует определённой суммы. Самые дешёвые стандартные юниты — это зомби (8 золотых), самые дорогие — наездники грифона (24 золотых). Призыв ранее служившего воина в кампании, независимо от его типа и уровня, стоит 20 золотых. Далее воин требует содержания, равного его уровню, за исключением верных персонажей, которые служат без жалованья. Если жалования, которое дают деревни, недостаточно для содержания воинов, то расходуются средства основной казны. Если же и они истощились, то в ходе сценария армия не разбегается, но в начале следующего сценария игрок получит только минимум денег, на который он сможет нанять или призвать минимум солдат.


== Многопользовательский режим ==
Кроме однопользовательского режима, имеется также многопользовательский с участием до 9 игроков, управляемых человеком или компьютером. Дипломатия отсутствует, но доступна командная игра. Играть можно:
на одной машине по очереди («горячий стул»);
на разных компьютерах по локальной сети (по протоколу TCP/IP);
через Интернет, создавая сервер на одной из участвующих в игре машин;
с помощью постоянно действующих выделенных серверов, поддерживаемых разработчиками игры и другими энтузиастами.
Обычная многопользовательская игра выглядит как единственный сценарий, в котором игроки противостоят друг другу. Если игра ведётся по принципу «все против всех», то она заканчивается, когда убиты все лидеры соперничающих сторон, кроме одного; если командная — выигрыш наступает, когда убиты все лидеры всех команд, кроме одной. Первоначальное количество денег у участников определяется хостером игры при создании партии.
Для многопользовательской игры в дистрибутиве имеется большое количество предустановленных сбалансированных (симметричных) карт: 17 — для двух игроков, 3 — для трёх, 14 — для четырёх, 3 — для пяти, 6 — для шести, 2 — для восьми и 1 — для девяти (версия 1.12). Помимо этого, можно создать случайную карту желаемых размеров с различными вариантами ландшафта — обычным, пустынным, болотистым, снежным. Случайные карты не сбалансированы, и выигрыш сильнее зависит от везения.
В процессе многопользовательской игры участники могут обмениваться текстовыми сообщениями, причём при командной игре возможна отправка приватных сообщений, видимых только партнёрами по команде. В игре по сети или через Интернет могут присутствовать наблюдатели, которые также имеют возможность отправлять сообщения, но только неприватные.
Другой важной особенностью многопользовательской игры является ограничение времени: хостер при создании партии может установить ограничение времени на ход — от 30 до 1500 секунд. (Обычно это значение находится в пределах 90 — 330 секунд.) Такая мера позволяет ускорить и/или усложнить игру.


=== Битвы на выживание ===
Интересной разновидностью многопользовательской игры является битва на выживание. В самом общем виде её можно описать так. Несколько игроков противостоят компьютеру. Компьютер постоянно или же с некоторой периодичностью (волнами) атакует человеческих игроков, причём в атаках прибывают всё более сильные юниты и/или большее их количество. Необходимо продержаться определённое число ходов (реже — уничтожить всех компьютерных противников).
В дистрибутиве игры предустановлены три подобных сценария. Все они, если не изменить настройки существенным образом (например, добавить много денег человеческим игрокам), достаточно сложны для прохождения.
Сценарий «Командное выживание» менее всего отличается по правилам от обычного сценария — в нём действуют обыкновенные бойцы по стандарным правилам. Противник прибывает волнами, каждый раз более сильный. Для победы нужно продержаться 32 хода.
Сценарий «Мрачный прогноз» имеет интересную особенность: ландшафт регулярно меняется — по сюжету это связано с изменением погоды. Там, где был луг, через несколько ходов может возникнуть пустыня или, наоборот, болото. Это хорошо демонстрирует исключительную гибкость программы, позволяющую менять любые параметры игры. В остальном «Мрачный прогноз» похож по правилам на «Командное выживание», но условия победы сложнее: нужно не только выжить в течение 45 ходов, но и уничтожить всех компьютерных бойцов.
Сценарий «Новая земля» самый необычный из трёх. В нём используется особая эра, которая по геймплею заметно отличается от обычного «Веснота» и напоминает игру Civilization. (Собственно, дальним предком этого сценария был аддон, который так и назывался — Wesnoth Civilization.) У человеческих игроков имеется всего одна раса — люди, в этой расе один боец-лидер, который вначале может призывать только магов и крестьян. Крестьяне умеют преобразовывать ландшафт, строить замки, деревни, рудники, фермы и университеты. Рудники и фермы служат для извлечения дополнительного дохода. Маги же занимаются в университетах науками: либо изучением технологии строительства новых юнитов (из расы людей), либо повышением производительности рудников и ферм. Если же в университет поместить лидера, то он может наладить дипломатию с гномами или эльфами и научиться призывать юнитов также из этих рас. Таким образом, упор делается не только на войну с прибывающими войсками компьютера, но и на всевозможное развитие. Ещё в сценарии есть ролевое задание: освободить из ловушек сильных бойцов, которые после этого примыкают к армии освободителя. В сценарии необходимо остаться в живых в течение 25 ходов, далее засчитывается победа, но при желании и наличии сил можно добить противника.


=== Многопользовательские кампании ===
С версии 1.6 в игре появились многопользовательские кампании — в них компьютеру противостоит не один игрок-человек, а несколько. В течение долгого времени они были доступны лишь в составе расширений (Trouble Times, Gobowars и другие). После долгой доработки в версии 1.12 появилась одна стандартная многопользовательская кампания — «Легенда Весмира», которая в более ранних версиях присутствовала в дистрибутиве лишь как однопользовательская.


=== Ладдер ===
Официально разработчики игры не поддерживают составление рейтингов и киберспортивные состязания по «Весноту», в частности, по соображениям безопасности: возможны различные способы жульнического поведения игроков (cheat), в том числе модификация кода игры. Тем не менее, часть игрового сообщества, заинтересованная в формальном определении силы игроков, создаёт сайты, где рассчитывается рейтинг игроков по системе Эло. Для этого необходимо зарегистироваться на сайте и затем участвовать в матчах по определённым правилам. Победитель высылает результат на сайт. Поскольку ладдер не является официальной частью «Веснота», то сайты эти могут изменяться. На текущий момент самым крупным является сайт Ladder of Wesnoth, но есть и другие версии ладдера.


=== Турниры Wesnoth Life ===
Русскоязычный проект Wesnoth Life проводит (без явно выраженной регулярности) турниры различного формата, преимущественно по кубковой системе. В них может принять участие любой желающий, зарегистрировавшись на сайте. Обычно все участники этих турниров из РФ и других стран бывшего СССР. Записи партий турниров доступны на сайте.


== Дополнения (add-ons) ==
Энтузиастами создано множество дополнений игры — от отдельных карт до эр и целых кампаний. Для версии 1.10 их число превысило 400 штук. Дополнения можно скачать и автоматически установить непосредственно из интерфейса игры (пункт меню «Аддоны»), либо же вручную с официального сервера. Лучшие из дополнений при хорошей отлаженности и достижении популярности могут быть доработаны и включены в стандартный дистрибутив игры (последний такой пример — кампания «Мёртвые воды»).


=== Проблемы с дополнениями ===
Так как аддоны не являются официальной частью «Веснота», то их поддержка лежит большей частью на первоначальном разработчике и на небольших группах энтузиастов. Поэтому на сервере довольно много дополнений, не оконченных в разработке, плохо портированных с предыдущей версии или содержащих иные серьёзные баги. Бывает, что разработчик забрасывает расширение на ранней стадии готовности, оно никем не портируется под следующую версию игры и исчезает навсегда. Впрочем, зачастую не портируются и вполне отлаженные версии. Кроме того, даже у лучших аддонов локализация намного беднее, чем у основной части игры; у большинства же присутствует только английский язык.


== Технические особенности ==


=== Кроссплатформенность ===
Поскольку код игры открыт под лицензией GPL и не привязан к проприетарным API, то «Битва за Веснот» легко портируется на различные операционные системы. На официальном сайте бесплатно доступны готовые пакеты актуальной и разрабатываемой версий игры для Microsoft Windows, Mac OS X и Pandora, а также даны ссылки на репозитории для установки актуальной версии в различных десктопных дистибутивах GNU/Linux. Кроме того, на сайте представлены пакеты устаревших (неподдерживаемых) версий для AmigaOS 4, Solaris, OS/2 и eComStation, RISC OS, Syllable. Помимо этого, заявлена совместимость с BeOS, FreeBSD, OpenBSD, NetBSD, DragonFly BSD.
Существуют порты версии игры 1.10 на Android и Apple iOS. Эти пакеты, в отличие от десктопных, распространяются за плату.
Наконец, на сайте выложен исходный код игры и инструкции по сборке, благодаря чему энтузиасты могут попробовать портировать игру на другие операционные системы и аппаратные платформы.


=== Системные требования ===
На официальном сайте содержатся сведения о системных требованиях программы (процессор x86 1 ГГц, ОЗУ 512 МБ), но они относятся к весьма устаревшей версии и помечены тоже как устаревшие. На официальном форуме приводятся сведения о запуске «Веснота» (также старых версий) на катастрофически устаревших к 2005 году машинах, например, на базе Pentium MMX 200 МГц. Исходя из этого опыта, из того, что существенного усложнения игры с вычислительной точки зрения не произошло, а также из того, что «Битва за Веснот» работает на таких довольно слабых устройствах, как смартфоны, можно сделать вывод, что запустится она на любом исправном компьютере, но, возможно, при использовании больших карт, многочисленных армий или сложных скриптов будут длительные паузы при ходах компьютерного игрока. На любом же компьютере, современном актуальной версии программы, она должна исполняться комфортно для пользователя.
Следует иметь в виду, что установка большого количества аддонов всегда снижает скорость работы программы, особенно время первоначального старта.


=== Справочная система ===
«Битва за Веснот» располагает развитой справочной системой с удобной навигацией, в которой описаны географические понятия Веснота, свойства ландшафта, бойцы и их особенности, общее управление игрой и другие вопросы. Особенно полезны для начинающих советы по тактике, выводящиеся на стартовый экран игры.


=== Языковая поддержка ===
Интерфейс игры переведён на более чем 50 языков и диалектов, однако завершённость и качество перевода не одинаковы для разных языков. Усилиями добровольцев происходит постоянное расширение и улучшение локализации. Завершённость русского перевода на 3 декабря 2013 г. оценивалась в 96,33%. Кроме официально входящей в дистрибутив, имеется неофициальная версия русского перевода.


=== Консольные команды ===
В игре можно вызвать командную консоль, нажав клавишу «двоеточие» в английской раскладке и затем введя собственно команду с параметрами. Команды особенно важны в многопользовательской игре, когда необходимо удалить отсоединившегося или некорректного игрока, передать управление и т. д. Например, команда :kick username удалит из игры игрока username. Команда :nosaves позволяет оперативно отключить автосохранения, что ускоряет игру. Также существуют отладочные команды, которые при желании можно использовать в качестве «чит-кодов». Полный список команд доступен на официальном сайте и в справочной системе программы.


== Разработка ==
Основной код программы написан на C++. Отображение графики производится с использованием библиотеки SDL.
Мультимедийные ресурсы хранятся в открытых форматах: изображения юнитов, заставки и другая графика — в PNG, музыка — в Ogg Vorbis. Это позволяет легко модифицировать имеющиеся ресурсы и создавать свои собственные, что способствует постоянному прогрессу оформления игры. Если интерфейс альфа-версии 0.1 сам создатель «Веснота» Д. Уайт характеризовал как «уродливый» и «ужасный», то уже к первому стабильному релизу 1.0 были заметны значительные улучшения.

Для создания новых и редактирования существующих карт в дистрибутив включён интуитивно понятный редактор карт, работающий по принципу WYSIWYG и содержащий все необходимые функции: определение размера карты, рисование любых типов ландшафтов, установка очерёдности ходов игроков. Редактор поддерживает многооконный режим с возможностью копирования фрагментов карты из одного окна в другое.


=== Искусственный интеллект ===
До версии 1.6 поддерживалось создание скриптов для искусственного интеллекта на языке Python, в версии 1.6. поддержка Python удалена в связи с вопросами безопасности. В ходе разработки версии 1.8 была добавлена возможность программирования ИИ с помощью языка Lua. В версии 1.12 имеется три предустановленных варианта ИИ: Default, Strong и Experimental.


=== Язык WML ===
Для «Веснота» был разработан так называемый язык WML (The Wesnoth Markup Language) , он значительно упрощает процесс разработки юнитов и фракций, сценариев и кампаний. Отдалённо он напоминает языки разметки, такие как HTML, поскольку там также фигурирует понятие тега. Пример простейшей карты, написанной на языке WML (файл example.cfg):

[multiplayer]
    id=Example_Map
    name=Example Map
    map_data="{~example.map}"
    description= _"Map Example"
    turns=-1
    players=4
    {DEFAULT_SCHEDULE}
[/multiplayer]


=== Google Summer of Code ===
Начиная с 2008 года, разработчики «Битвы за Веснот» ежегодно участвуют в проекте Google Summer of Code. В 2014 году также было принято участие в этом мероприятии.


== Влияние на другие игры ==
Как отмечено выше, благодаря свободе модификации кода и ресурсов разработчики создали множество дополнений, некоторые из которых весьма существенно отличаются по правилам от исходной игры. Но всё же основные параметры большинства дополнений находятся в сюжетных рамках, заданных сагой о Весноте. Тем не менее, в 2005-2007 годах существовало как минимум одно дополнение, которое, используя движок Battle for Wesnoth, фактически представляло собой отдельную футуристическую стратегию с собственным сюжетом, которая называлась Spacenoth. Хоть она и не была окончена в разработке, на основе исходного кода (недоступного по состоянию на 2015 год), описания сюжетов и юнитов, а также других ресурсов Spacenoth, игрок "Bob_The_Mighty" преобразил его в аддон "Galactic Empires".
Помимо этого, независимый разработчик из Испании Jon Ander Peñalba в 2008-2009 гг. трудился над игрой под названием «Герои Веснота» (Heroes of Wesnoth). По утверждению автора, он был намерен создать аналог игры «Герои меча и магии», используя графику (и некоторые сюжетные элементы) «Битвы за Веснот», но на базе собственного программного кода. Однако разработка была заброшена на стадии альфа-версии. Тем не менее, исходный код под лицензией GPL v.3 доступен на launchpad.net, теоретически развитие игры может быть продолжено. Интересно, что создатели популярного репозитория getdeb.net до сих пор собирают последнюю версию Heroes of Wesnoth (0.1.2) для новейших выпусков Ubuntu .
Также «Битва за Веснот» оказала влияние на создание стратегии реального времени Wyrmsun на движке Stratagus. Автор указывает:


== Примечания ==


== Ссылки ==

Официальный сайт игры
Русскоязычный сайт
Русскоязычное сообщество
Официальный аккаунт в Twitter
Участник альянса свободных игр FreeGameAlliance
«The Battle for Wesnoth, Официальная android-версия лучшей бесплатной пошаговой стратегии!» на форуме 4pda.ru
Обзор игры в журнале «Игромания»
Интервью с Дэвидом Уайтом (англ.)